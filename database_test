--This document shows database creation and it's output as well as how queries were tested and the output.--
------------------------------------------------------------------------------------------------------------



-------------------------------Creating database---------------------------------------
up900921=# create database mealprep;
CREATE DATABASE

up900921=# \c mealprep;
You are now connected to database "mealprep" as user "up900921".




----------------------------------Creating tables--------------------------------------
mealprep=# create table cuisine (
    cuisine_id serial primary key,
    cuisine_name varchar(20) not null
    );
CREATE TABLE

mealprep=# create table recipe (
    recipe_name varchar(25) not null,
    cooking_time varchar(10),
    calories int,
    fat int,
    protein int,
    salt int,
    sugar int,
    fibre int, 
    carbonhydrates int
    );
CREATE TABLE

mealprep=# create table allergen (
     allergen_id serial primary key,
     allergen_name varchar(20) not null
     );
CREATE TABLE

mealprep=# create table recipe_cuisine (
     recipe_id int not null,
     cuisine_id int not null,
     foreign key (recipe_id) references recipe(recipe_id),
     foreign key (cuisine_id) references cuisine(cuisine_id)
     );
CREATE TABLE

mealprep=# create table recipe_allergen (
     recipe_id int not null,
     allergen_id int not null,
     foreign key (recipe_id) references recipe(recipe_id),
     foreign key (allergen_id) references allergen(allergen_id)
     );
CREATE TABLE

mealprep=# create table app_user (
    user_id serial primary key,
    first_name varchar(50) not null,
    last_name varchar(50),
    email varchar(50) not null,
    calories int,
    allergen_id int,
    cuisine_id int,
    foreign key (allergen_id) references allergen(allergen_id),
    foreign key (cuisine_id) references cuisine(cuisine_id)
);
CREATE TABLE

mealprep=# create table user_allergen (
    user_id int not null,
    allergen_id int not null,
    foreign key (user_id) references app_user(user_id),
    foreign key (allergen_id) references allergen(allergen_id)
);
CREATE TABLE

mealprep=# create table user_cuisine (
     user_id int not null,
     cuisine_id int not null,
     foreign key (user_id) references app_user(user_id),
     foreign key (cuisine_id) references cuisine(cuisine_id)
     );
CREATE TABLE




------------------------------Testing select queries---------------------------
mealprep=# select recipe_name, cooking_time, calories, cuisine_name
    from recipe 
    join recipe_cuisine on recipe.recipe_id = recipe_cuisine.recipe_id
    join cuisine on recipe_cuisine.cuisine_id = cuisine.cuisine_id;
    
     recipe_name | cooking_time | calories | cuisine_name 
-------------+--------------+----------+--------------
 libero      | 1:00         | 425      | portugese
 amet        | 0:15         | 665      | mexican
 quam sapien | 1:15         | 553      | british
 quam sapien | 1:15         | 553      | thai
 quam sapien | 1:15         | 553      | mexican
 id          | 0:35         | 255      | american
 quam        | 0:30         | 482      | french
 curae donec | 0:40         | 716      | greek
 leo rhoncus | 0:50         | 225      | british
 leo rhoncus | 0:50         | 225      | japanese
(10 rows)

mealprep=# select recipe_name, cooking_time, cuisine_name
    from recipe
    join recipe_cuisine on recipe.recipe_id = recipe_cuisine.recipe_id
    join cuisine on recipe_cuisine.cuisine_id = cuisine.cuisine_id
    where cooking_time ILIKE '%0:30%';
     
     recipe_name | cooking_time | cuisine_name 
-------------+--------------+--------------
 quam        | 0:30         | french
(1 row)

mealprep=# select recipe_name, cooking_time, cuisine_name
    from recipe
    join recipe_cuisine on recipe.recipe_id = recipe_cuisine.recipe_id
    join cuisine on recipe_cuisine.cuisine_id = cuisine.cuisine_id
    where cuisine.cuisine_id = 1;
    
     recipe_name | cooking_time | cuisine_name 
-------------+--------------+--------------
 leo rhoncus | 0:50         | japanese
(1 row)

mealprep=# select recipe_name, cooking_time
    from recipe
    join recipe_allergen on recipe.recipe_id = recipe_allergen.recipe_id
    join allergen on recipe_allergen.allergen_id = allergen.allergen_id
    where allergen.allergen_id not in (1, 2);
    
       recipe_name   | cooking_time 
-----------------+--------------
 libero          | 1:00
 quam            | 0:30
 amet            | 0:15
 curae donec     | 0:40
 nec             | 0:15
 libero          | 1:00
 libero          | 1:00
 ultrices enim   | 0:25
 quam            | 0:30
 lobortis sapien | 0:30
(10 rows)

mealprep=# select recipe_name, cooking_time, calories
    from recipe
    where calories < '600';
    
     recipe_name  | cooking_time | calories 
---------------+--------------+----------
 nec           | 0:15         | 316
 quam sapien   | 1:15         | 553
 libero        | 1:00         | 425
 quam          | 0:30         | 482
 leo rhoncus   | 0:50         | 225
 ultrices enim | 0:25         | 424
 id            | 0:35         | 255
(7 rows)

mealprep=# select recipe_name, cooking_time, protein
    from recipe
    where protein > '15';
    
       recipe_name   | cooking_time | protein 
-----------------+--------------+---------
 lobortis sapien | 0:30         | 47
 nec             | 0:15         | 43
 quam sapien     | 1:15         | 79
 libero          | 1:00         | 84
 curae donec     | 0:40         | 94
 amet            | 0:15         | 75
 quam            | 0:30         | 18
 leo rhoncus     | 0:50         | 75
 ultrices enim   | 0:25         | 59
 id              | 0:35         | 18
(10 rows)

mealprep=# select recipe_name, cooking_time, sugar
    from recipe
    where sugar < '25';
    
     recipe_name | cooking_time | sugar 
-------------+--------------+-------
 amet        | 0:15         | 24
 quam        | 0:30         | 16
(2 rows)

mealprep=# select recipe_name, cooking_time, fat
    from recipe
    where fat < '30';
    
     recipe_name | cooking_time | fat 
-------------+--------------+-----
 amet        | 0:15         | 2
(1 row)


mealprep=# select recipe_name, cooking_time, salt
     from recipe
    where salt < '15';
    
     recipe_name | cooking_time | salt 
-------------+--------------+------
 id          | 0:35         | 11
(1 row)


